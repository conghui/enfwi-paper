clc;clear;close all

fwi = [0.179198,0.179969,0.180469,0.181196,0.181336,0.181377,0.181579,0.181764,0.182291,0.182618,0.182727,0.18323,0.183629,0.183717,0.18373,0.184229,0.184381,0.184404,0.184619,0.184867,0.184932,0.185231,0.185511,0.18553,0.185529,0.185534,0.185829,0.185972,0.185973,0.186041,0.186042,0.186043,0.186045,0.186046,0.186048,0.186049,0.186051,0.186053,0.186055,0.186057,0.186059,0.18606,0.186062,0.186064,0.186065,0.186067,0.186069,0.186071,0.186073,0.186083,0.186133,0.186336,0.186403,0.186405,0.186406,0.186407,0.186408,0.18641,0.186411,0.186443,0.186444,0.186446,0.186447,0.186449,0.186451,0.186452,0.186454,0.186456,0.186457,0.186459,0.186461,0.186462,0.186464,0.186466,0.186468,0.186469,0.186471,0.186472,0.186474,0.186476,0.186486,0.186588,0.18675,0.186909,0.186911,0.186913,0.186915,0.186917,0.186918,0.186951,0.186953,0.186955,0.186957,0.186959,0.186961,0.186963,0.186964,0.186966,0.186967,0.186969,0.186971,0.186972,0.186974,0.186976,0.186977,0.186979,0.18698,0.186981,0.186983,0.186985,0.186986,0.186987,0.186989,0.18699,0.186991,0.186993,0.186994,0.186995,0.186996,0.186998,0.187,0.187001,0.187002,0.187003,0.187004,0.187006,0.187007,0.187008,0.187009,0.187011,0.187012,0.187013,0.187014,0.187015,0.187016,0.187017,0.187018,0.18702,0.187021,0.187022,0.187023,0.187025,0.187026,0.187027,0.187028,0.187029,0.187043,0.187162,0.18736,0.187481,0.187481,0.187481,0.187481,0.187481,0.18748,0.18748,0.18748,0.18748,0.18748,0.187481,0.187481,0.187481,0.187483,0.187508,0.187631,0.187632,0.187631,0.187629,0.187628,0.187641,0.18764,0.187639,0.187639,0.187638,0.187638,0.187638,0.187638,0.187637,0.187637,0.187637,0.187637,0.187637,0.187637,0.187637,0.187638,0.187638,0.187638,0.187638,0.187639,0.187639,0.18764,0.18764,0.187641,0.187641,0.187642,0.187642,0.187642,0.187643,0.187644,0.187644,0.187645,0.187646,0.187646,0.187647,0.187647,0.187648,0.187649,0.187653,0.187702,0.187842,0.187843,0.187842,0.187841,0.187841,0.18784,0.187839,0.187839,0.187839,0.187839,0.187838,0.187838,0.187838,0.187838,0.187838,0.187838,0.187838,0.187838,0.187838,0.187839,0.187839,0.187839,0.187839,0.18784,0.18784,0.18784,0.187841,0.187841,0.187841,0.187842,0.187843,0.187843,0.187843,0.187844,0.187844,0.187845,0.187854,0.187992,0.187992,0.187993,0.188007,0.188008,0.188009,0.18801,0.188011,0.188012,0.188013,0.188014,0.188015,0.188015,0.188017,0.188017,0.188018,0.188019,0.18802,0.188021,0.188021,0.188022,0.188023,0.188024,0.188025,0.188026,0.188027,0.188028,0.188029,0.18803,0.18803,0.188031,0.188032,0.188033,0.188034,0.188035,0.188035,0.188036,0.188037,0.188038,0.188038,0.188039,0.18804,0.188041,0.188042,0.188043,0.188044,0.188044,0.188045,0.188046,0.188047,0.188047,0.188048,0.188049,0.18805];
esfwi = [0.0115997,0.0122319,0.0126654,0.0130773,0.0135982,0.0140303,0.0145752,0.0150575,0.0155089,0.0158982,0.0162269,0.0164907,0.0168007,0.0169651,0.0172528,0.017344,0.0173994,0.0175014,0.0174755,0.017326,0.0172196,0.0170507,0.0169281,0.0168341,0.016758,0.0167094,0.0166623,0.0166105,0.0166241,0.0167326,0.0168833,0.0169814,0.017026,0.0169753,0.0169416,0.0169078,0.0169231,0.0169753,0.0169987,0.0170157,0.0169972,0.0169688,0.0169407,0.0168805,0.0168643,0.0168267,0.0167739,0.016739,0.016649,0.0165537,0.0164403,0.0164029,0.0163696,0.0163216,0.0162592,0.016227,0.0161152,0.0160415,0.0160016,0.0159639,0.0159395,0.0158962,0.0158477,0.0158268,0.0157896,0.0157461,0.0157064,0.0156353,0.0155947,0.0155428,0.0155039,0.0154898,0.0154896,0.0154869,0.0154738,0.0154514,0.0154185,0.0154029,0.0153757,0.0153601,0.0153443,0.0153419,0.0153211,0.0152743,0.0152292,0.0152076,0.0151739,0.0151518,0.0151156,0.0150869,0.0150498,0.0150392,0.0150391,0.0150393,0.0150489,0.0150413,0.015005,0.0149744,0.0149412,0.0149303,0.0149104,0.0148805,0.014856,0.0148169,0.0147907,0.0147751,0.0147564,0.0147504,0.014733,0.0147171,0.0146918,0.014669,0.0146445,0.0146274,0.0146126,0.0146045,0.0146017,0.0145959,0.0145877,0.0145767,0.0145677,0.014561,0.0145566,0.0145406,0.0145175,0.0144934,0.0144849,0.0144731,0.0144672,0.0144656,0.0144653,0.0144615,0.0144568,0.0144459,0.0144333,0.0144251,0.0144136,0.01441,0.0144064,0.014406,0.0144007,0.0143898,0.0143845,0.0143788,0.0143752,0.0143653,0.0143497,0.0143372,0.0143207,0.0143165,0.0143154,0.0143152,0.0143154,0.014316,0.0143159,0.0143056,0.0142928,0.0142853,0.0142797,0.0142751,0.0142686,0.0142662,0.014266,0.0142713,0.0142714,0.01428,0.014283,0.0142868,0.0142887,0.0142882,0.0142697,0.014266,0.0142634,0.0142648,0.0142601,0.0142492,0.0142289,0.0142018,0.0141942,0.014184,0.0141777,0.01417,0.0141492,0.0141343,0.0141227,0.0141185,0.0141117,0.0141039,0.0140914,0.0140831,0.0140783,0.0140854,0.0140924,0.0141035,0.0141113,0.0141088,0.0141164,0.0141159,0.0141124,0.0141168,0.0141229,0.0141265,0.0141308,0.0141186,0.0140999,0.0140945,0.0140671,0.0140464,0.0140397,0.0140334,0.0140274,0.0139841,0.0139582,0.0139255,0.0139115,0.0138938,0.013879,0.0138727,0.0138502,0.0138415,0.013829,0.0138278,0.0138365,0.0138348,0.013817,0.0138037,0.0138036,0.0137994,0.0137932,0.013786,0.0137531,0.0137369,0.0137217,0.0137059,0.013702,0.0136871,0.013675,0.0136706,0.013669,0.0136625,0.0136431,0.0136244,0.0136158,0.0136142,0.013607,0.0135962,0.0135811,0.0135739,0.0135612,0.0135542,0.0135492,0.01354,0.0135356,0.013532,0.0135204,0.0135107,0.0134973,0.0134867,0.0134744,0.013467,0.0134574,0.0134505,0.0134462,0.0134469,0.0134491,0.0134491,0.013444,0.013437,0.0134231,0.0134096,0.0134075,0.0134117,0.0134102,0.0134171,0.0134093,0.0134018,0.0133913,0.0133806,0.0133737,0.0133718,0.0133673,0.0133571,0.0133445,0.0133289,0.0133194,0.0133074,0.0133026,0.0132941,0.0132832,0.0132799,0.0132804,0.0132711,0.0132555,0.0132381,0.0132193,0.0132125,0.0132117,0.0132137,0.0132107,0.0132088];
enfwi = [0.0115457,0.0115054,0.011476,0.0114381,0.0114192,0.0113968,0.0113813,0.0113611,0.0113509,0.0113311,0.01132,0.0113038,0.0112876,0.0112719,0.0112555,0.0112425,0.0112266,0.0112149,0.0112032,0.0111838,0.0111742,0.0111558,0.0111431,0.0111308,0.0111202,0.0110946,0.0110854,0.0110698,0.0110613,0.0110498,0.011041,0.0110262,0.0110138,0.0110019,0.0109884,0.0109787,0.0109691,0.0109611,0.0109487,0.010937,0.0109264,0.0109162,0.0109054,0.0108889,0.0108826,0.0108734,0.0108649,0.0108595,0.0108501,0.0108376,0.0108302,0.0108131,0.0108044,0.0107981,0.0107896,0.0107797,0.0107712,0.0107569,0.0107487,0.0107432,0.0107386,0.0107301,0.0107193,0.0107115,0.0107044,0.0106997,0.0106882,0.0106788,0.0106737,0.0106651,0.0106551,0.0106515,0.0106447,0.0106369,0.0106293,0.0106229,0.0106164,0.0106074,0.0106001,0.0105924,0.0105847,0.010579,0.0105715,0.0105646,0.0105545,0.0105483,0.0105406,0.0105364,0.0105222,0.0105194,0.0105101,0.0105038,0.0104984,0.0104939,0.0104821,0.0104777,0.0104713,0.0104652,0.010462,0.0104547,0.0104449,0.0104398,0.0104341,0.0104288,0.0104194,0.0104133,0.0104065,0.0104019,0.0103972,0.0103903,0.0103848,0.0103801,0.0103729,0.0103674,0.0103574,0.0103482,0.0103371,0.0103283,0.0103207,0.0103182,0.0103117,0.0103038,0.0102953,0.0102916,0.0102821,0.0102788,0.010273,0.0102675,0.0102626,0.0102562,0.0102488,0.0102415,0.0102338,0.0102312,0.0102252,0.0102202,0.0102132,0.010208,0.0102029,0.0101941,0.0101855,0.010182,0.0101737,0.0101685,0.0101605,0.0101545,0.0101442,0.0101409,0.0101314,0.0101278,0.010124,0.0101203,0.0101128,0.0101073,0.0101017,0.0100985,0.010094,0.0100905,0.0100863,0.0100818,0.0100732,0.0100695,0.0100632,0.010055,0.0100488,0.0100445,0.0100405,0.0100292,0.0100245,0.0100203,0.0100157,0.0100125,0.0100056,0.00999634,0.0099905,0.00998738,0.0099828,0.00997934,0.00997171,0.0099701,0.00996277,0.00995703,0.00994656,0.00994325,0.00993694,0.0099337,0.00992983,0.00992607,0.00991869,0.00991579,0.00991218,0.00990707,0.00989629,0.00989173,0.00988793,0.00988421,0.0098784,0.00987616,0.00986925,0.00986767,0.0098623,0.00985924,0.00985396,0.00984914,0.00984168,0.00983745,0.00983262,0.0098291,0.00982447,0.00982144,0.00981772,0.00980729,0.00980338,0.00979879,0.00979562,0.00979348,0.00978863,0.00978451,0.00977953,0.00977443,0.00976695,0.00976377,0.00975866,0.00975486,0.00974915,0.00974457,0.00973881,0.00973373,0.00972876,0.00972555,0.00972099,0.00971645,0.00971214,0.00970869,0.00970535,0.0097001,0.0096935,0.00968821,0.00968332,0.00967949,0.00967645,0.00967275,0.00967055,0.00966673,0.00966335,0.00965946,0.00965703,0.00965129,0.009646,0.00964351,0.00963748,0.0096254,0.0096194,0.00961211,0.00961095,0.00960719,0.00959964,0.00959673,0.00959392,0.00958453,0.00958312,0.00958068,0.00957335,0.00957042,0.00956836,0.00956183,0.00956088,0.00955727,0.00955151,0.00954703,0.00954354,0.00953907,0.00953562,0.00953134,0.00952822,0.00951608,0.00951433,0.00950756,0.00950426,0.00949935,0.00949855,0.00949486,0.00949128,0.00948533,0.00948114,0.00947737,0.00947231,0.00946986,0.00946623,0.00946419,0.0094589,0.00945626,0.00944885,0.00944511,0.00944107,0.00943305,0.00942893,0.00942578,0.00942293,0.00942068,];

fwi = fwi / fwi(1);
esfwi = esfwi / esfwi(1);
enfwi = enfwi / enfwi(1);
n = size(fwi, 2);

im2 = plot([1:n], fwi, '-', ...
    [1:n], esfwi, '-',  ...
    [1:n], enfwi, '-', ...
    'MarkerSize', 4, 'Linewidth', 2);

%set(gca, 'XTick', [1:8]);
%set(gca,'xticklabel','Iterations');
%axis([1 300 0 30]) 
grid minor
h_legend = legend('FWI', 'ESSFWI',  'ENFWI', 'Location', 'northeast');
xlabel('Iterations');
ylabel('Normalized Slowness');
%text(3.7, 6,'DMA\_get', 'FontSize', 16, 'FontName', 'TimesNewRoman', 'FontAngle','italic')
set(gca, 'FontAngle','italic');
set(gca, 'FontSize', 13);
set(findall( 0, 'FontName', 'Helvetica' ), 'FontName', 'TimesNewRoman' )
